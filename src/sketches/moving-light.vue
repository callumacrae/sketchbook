<template>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 508 317.5">
    <path
      d="M242.358 97.631c4.234.794 13.494-.529 13.494-.529-.894-2.892-1.164-4.586-7.673-3.969 1.25.31 2.506-1.351 6.722-5.445 1.521-1.477.091-3.006 5.449-5.403-4.96-.16-9.701.946-14.552 5.292 3.686-7.232.28-12.597-2.117-18.52-4.024 6.621-6.292 12.073-6.085 15.874l-8.467-7.673c2.092 6.676 4.447 12.695 7.938 15.875l-6.35 3.705s6.085.793 11.641.793z"
    />
    <path
      d="M205.846 103.981c-.126-6.336 5.325-15.013 5.027-15.61-5.316 2.287-10.466 3.413-15.081.794-5.298-3.007 13.493-5.292 13.493-5.292l-6.879-3.44 3.175-4.233s5.292 3.44 6.086 4.763c.793 1.322-.265-5.028-.265-5.028s4.233 6.086 4.763 8.732c.529 2.646 2.116 13.229 3.44 14.552 1.322 1.323-5.028-6.88-5.028-10.584 0-3.704-2.646 6.88-2.646 6.88z"
    />
    <path
      d="M203.2 37.835l3.969-4.497 1.587-6.615a83.006 83.006 0 00-5.291 8.202c-2-6.41-4.008-7.493-7.409-8.996-.632 3.752.841 5.126 2.91 8.202l-13.229-3.175c6.754 4.39 12.776 5.246 17.463 6.88z"
    />
    <path
      d="M191.558 49.742c-1.43-2.646-3.508-5.292-6.35-7.938-2.205-.57-4.41-2.264-6.614-4.233l5.027 8.202-6.086-.794 5.028 4.234 3.968.529c2.91.264-4.762 3.704-4.762 3.704l-2.91 3.44h5.82l4.498-2.117-2.646 7.408s6.615-2.646 5.027-12.435z"
    />
    <path
      d="M208.227 66.41v-4.497l-7.408-6.88 3.704 10.055-7.673-4.763-4.791.172-2.088 1.945 8.996 5.027-7.938-.265-12.17 7.409 13.493-1.323 7.408-1.323-4.497 7.937 2.116 6.086 7.673-8.732.794-6.085 5.027 5.82-.265-8.201z"
    />
    <path
      d="M209.285 120.915l-10.847-2.646 9.524-3.175c6.615-2.646 7.938 1.058 7.938 1.058l3.44.794-5.028-7.938v-3.44l2.117 3.44 2.117.265 5.027 6.085 1.058-2.91 1.588 2.646-3.704 19.314-4.763-.529-.53-6.614-8.201 3.44-8.731-1.324 10.054-6.614z"
    />
    <path
      d="M240.77 121.444l-.264 6.085-5.027-4.498c-5.44 2.623-10.474 4.922-12.435 4.763-.363-1.03 2.659-3.292 10.054-7.144-10.696-.065-15.39-2.702-21.431-4.762 7.825-.32 15.34-2.503 23.812 1.058l-8.731-14.288 11.377 10.584 2.91-2.91.53 5.82z"
    />
    <path
      d="M259.292 139.17l1.058-9.524 5.556 7.673 3.175-1.852-4.498 11.112c-9.313-2.23-6.16-8.749-12.964-13.494z"
    />
    <path
      d="M261.144 122.238c2.457 5.646 5.18 10.823 8.731 14.552l11.642-5.557-3.704-1.587 2.645-3.44-1.323-7.673-5.027 5.292c-3.35 1.28-3.28 4.269-3.968 6.88-2.165-3.24-5.431-5.929-8.996-8.467z"
    />
    <path
      d="M290.777 138.113l-3.44-10.055c-.986 3.545-1.732 6.848-1.322 8.996l-12.7-8.996 3.704 10.848-20.373 5.292c6.964 3.182 15.098 10.108 28.046 1.323-1.797 5.17-5.967 7.968-9.79 11.112 3.528-.589 7.056-.774 10.583-4.762l3.175 2.91 2.646-7.673-1.852-4.762z"
    />
    <path
      d="M232.569 141.817c-1.067 7.055-4.285 14.11-7.409 21.166l1.059-11.906-7.409 7.938 2.117-9.26 3.175-4.234-5.556-3.969c3.344-3.556 7.651-3.261 11.641-4.233z"
    />
    <path
      d="M202.935 179.917l-5.82-10.32 1.058 7.938c-1.289-2.31-7.679-2.07-12.965-2.38 2.982 4.99 6.992 6.893 11.377 7.672l-8.466 1.852-4.763 10.848 8.732-2.646 5.82-4.233-4.762 8.731v8.202l3.704-8.731 1.852-6.35 4.763 6.35v-11.377z"
    />
    <path
      d="M238.125 172.508l-12.965-6.085 14.552-3.704-4.762-9.525c4.075.562 8.386 4.89 12.7 9.26l5.027-9.525c.057 9.185-.592 15.31-2.646 15.346l3.175 9.525-3.175-3.969-3.175 8.732-2.646-8.732-15.345 7.673z"
    />
    <path
      d="M144.992 214.577l-5.027-10.319-.53 6.88c-3.616-4.168-7.232-2.658-10.848-2.117l4.498 5.292-12.17 7.672c4.85.561 12.347-1.472 17.197-3.704l-9.525 8.996 11.378-4.762 3.175 3.44z"
    />
    <path
      d="M120.65 231.246l-7.408 5.292 9.525-1.323c2.265 6.401-.068 8.862-2.646 11.112 2.933-2.352 6.377-4.067 6.614-9.79l2.117 4.498-1.323-11.377-11.112-5.82z"
    />
    <path
      d="M152.665 225.954c-3.837-1.675-9.385.072-14.552 1.059 5.38 1.372 10.76 3.878 16.14 2.645-4.288 4.31-5.89 7.726-8.203 11.377 4.024-3.4 8.88-5.552 11.642-10.847l2.116 9.525-.529-11.642 1.323-4.763-3.704 2.117-6.35-7.144z"
    />
    <path
      d="M174.89 234.42c-2.598 5.035-4.346 9.989-4.763 14.818 2.635-3.685 5.672-4.952 7.673-12.436l5.027 6.35-3.969-11.642c.438-4.055-.985-7.18-1.852-10.583l-1.323 9.525c-.187-3.142-8.442-3.595-14.552-4.762l7.938 6.879c-4.012 1.628-8.25 3.934-12.965 7.673 5.496 1.051 13.974-2.764 18.786-5.821z"
    />
    <path
      d="M173.037 211.138l-10.054-13.759c.888 4.721 1.424 9.267 5.027 15.346-8.76-2.425-11.505-.338-14.816 1.323 2.748 3.24 6.512 4.785 11.377 4.498l-4.498 6.085c5.318-1.564 8.79-3.286 10.583-5.556l-2.646 12.435c3.566-5.96 5.394-6.777 6.88-14.816l-.265-15.081z"
    />
    <path
      d="M192.352 222.515l-12.7-7.144c6.152.014 12.79-.295 16.933 1.058l-2.116-6.35c2.803 1.395 5.612 2.785 6.35 5.556l1.323 5.292 4.762 5.027c2.6 5.765 1.297 8.601 1.323 12.436l-5.027-10.055c-1.815 5.179-4.47 10.525-9.79 16.405l4.234-17.727c-5.97 5.337-12.66 4.903-19.315 4.762 3.178-3.85 8.734-6.803 14.023-9.26z"
    />
    <path
      d="M211.402 221.192c-7.665 1.569-11.034-1.266-13.758-4.763l15.346 1.852c-6.943-3.187-8.812-8.911-8.732-15.61 5.322 3.81 9.824 8.11 11.642 14.023l3.969-11.906c.35 4.837 3.527 9.058-.794 13.229l9.79-1.323c-4.234 1.842-8.467 4.456-12.7 5.027-3.398 4.262-6.993 5.411-10.584 6.614z"
    />
    <path
      d="M240.77 196.585c-6.483 11.233-10.79 8.674-16.403 8.467l9.525-8.467c-3.444 1.141-9.388-.842-15.61-3.175 5.908-1.765 11.817-3.332 17.726-3.704l-4.233-13.493c4.43 4.41 11.276 8.819 11.906 13.229l3.704-8.467-1.852 12.965c-.676 5.626-.95 11.494-5.027 15.08z"
    />
    <path
      d="M266.965 202.67c-2.332-3.4-4.461-5.416-8.203-7.407.928 7.45.91 14.259 5.292 18.256l-12.17-.794c4.776 2.882 9.707 5.455 15.874 5.556l8.202 2.117 10.32-1.852c-.622-2.885-6.458-2.924-14.818-1.588 12.252-5.469 12.353-12.807 16.14-19.579l-12.435 9.26c.177-8.985.758-12.1 1.587-15.874-4.251 2.651-7.653 6.435-9.79 11.906z"
    />
    <path
      d="M273.844 165.63l8.466 2.91-4.233-3.705 13.758-.529-11.906-2.646-.264-7.143-7.673-2.382-2.382 4.763v5.292l-3.175 1.587z"
    />
    <path
      d="M296.598 169.598l5.556-7.144 4.498-.264c2.219-4.769 5.324-4.219 8.202-5.027-2.91-.794-6.807-.602-13.229 2.116 3.612-3.463 4.935-10.13 5.027-18.52-3.678 3.704-8.139 7.408-8.467 11.112l-7.408-13.758-2.117 16.668-8.995-.264c7.888 8.736 8.752 7.439 12.17 9.79l4.117.634z"
    />
    <path
      d="M249.237 218.546c2.744-2.992 5.89-5.716 6.615-10.054l-2.91.793-5.557-2.91.794 5.292c-4.024.2-14.35 2.866-16.404 6.35l13.758-.794c-8.453 3.792-10.72 7.585-14.552 11.377 6.086-4.291 12.171-7.874 18.256-10.054z"
    />
    <path
      d="M193.326 281.219c-1.728-4.214-5.417-7.121-9.126-10.014l4.436 9c-5.124-2.348-11.218-1.432-16.996-1.488 5.008 3.79 10.847 4.71 16.87 4.783-10.407 2.256-12.345 7.33-15.432 12.55l14.797-6.465c-2.84 4.985-1.06 7.325-2.088 12.311l7.032-11.297 3.296 9.253-.127-15.718z"
    />
    <path
      d="M206.994 268.603c-4.481.192-7.078.999-7.86 2.536 2.071 2.843 3.254 3.258 5.324 3.422-2.682 2.848-6.094 5.404-7.225 8.873l7.732-4.056-2.535 6.21 9-13.055-.634-8.366-1.394 3.422-2.155-5.577z"
    />
    <path
      d="M201.249 291.65l-.525 4.623 3.888 5.886-1.576-12.086 2.627 3.363-3.233-7.847-6.971-3.042.535 4.899 2.628-.526-2.61 2.212-.228 8.403 3.048-2.523 1.471-5.464z"
    />
    <path
      d="M212.284 285.445l-7.252 12.611 7.567-7.776-2.207 9.353c7.5-4.612 7.45-8.28 8.512-12.086l3.678 6.306c.424-2.8 1.916-4.983-2.732-10.72l1.892-3.783-4.624-8.512v9.353c-4.8-1.263-9.599-.138-14.398 1.366 3.796.81 7.164 1.961 9.564 3.888z"
    />
    <path
      d="M229.526 282.93l-8.618 1.262 3.574 6.41 6.2-3.678c-1.288.817-6.336 6.914-7.23 9.826-1.881 6.14-3.633 7.07-6.852 12.558 4.99-3.832 9.881-7.366 15.133-11.98l3.047-8.828 1.156 1.577-1.681 10.299 3.888 10.088 2.628-12.085-2.943-11.665 4.204 6.095 5.78 2.312-10.825-11.455-3.993-7.04.315 3.572c-1.969-1.471-3.708-2.942-7.566-4.414.078 2.89 1.763 5.09 3.783 7.147z"
    />
    <path
      d="M255.889 277.665l-4.94 7.987c3.008-1.557 6.325-2.184 8.828-5.255l2.627 3.678 1.682 6.2c.502-5.319 1.846-9.917 4.309-13.556l-2.838-3.888 2.838-4.099-4.31-9.773-1.786 8.512-12.4-6.83 7.25 10.088c-4.318-.422-7.855 1.896-11.664 3.258z"
    />
    <path
      d="M236.454 249.748l-6.62 10.299c5.212-2.7 10.714-5.22 12.4-10.089l2.207 7.356c.972-1.614 1.445-5.886 1.577-11.98-.15-1.652-3.234-7.118-6.096-12.296l-.21 7.042-9.248-5.886c.1 4.592 3.018 7.775 8.723 9.564-9.938-.576-12.215 5.36-17.025 9.143z"
    />
    <path
      d="M256.527 232.378l-3.783-14.292-1.892 6.41-9.563-5.254 3.678 8.617-3.153 2.733 3.048 5.044z"
    />
    <path
      d="M259.049 241.532l5.15 5.465-4.632-1.452c-.271 4.386 1.492 9.142-6.106 12.197l3.591-12.637-7.671 3.363-2.102-3.678 3.888-3.888-6.305-3.678 6.515-.841 4.835 2.732.315-5.15 2.627 4.625z"
    />
    <path
      d="M278.074 259.3l2.207 9.143 1.261-8.512-1.156-5.99-3.678-10.194-.315 5.99-6.2-1.156 4.728 5.36c-2.114.618-4.078 1.386-5.36 2.837l-1.365 6.83 6.515-6.2z"
    />
    <path
      d="M241.604 262.96l2.732 7.04 1.892-14.607-5.57-5.15-5.15 8.513-8.196 3.468 4.413.42-4.834 6.516 8.828-.84 5.254-5.255z"
    />
    <path
      d="M283.1 224.301l1.156 15.028 3.363-7.882-2.312-7.882 5.254 8.092 5.15 5.15-.42-9.563-8.918-5.737c3.004.262 10.683.172 12.1-1.152-.64-1.719-5.466-2.658-8.017-3.83-4.162 1.675-5.323 3.327-7.025 4.457z"
    />
    <path
      d="M331.348 199.507c-1.468-10.21 12.27-16.425 2.417-1.787 3.385-5.171 13.08-6.587 19.269-6.714-1.415 3.624-9.907 5.437-15.801 8.501 6.18-.805 11.131 6.636 15.77 9.426-2.266 1.851-8.495-1.189-16.926-3.54 3.498 4.704 3.09 7.535 4.142 11.968-2.873-1.65-4.422-2.624-7.295-7.345l-.105-6.305-7.897 6.61c.443-3.484-1.329-6.438 6.426-10.814z"
    />
    <path
      d="M357.414 199.485c-1.789-4.557 2.273-7.86 3.993-11.665l2.523 5.36c2.345-4.802 8.547-5.746 13.451-7.988l-7.776 11.35c6.165 1.892 10.369 3.924 12.61 6.095-4.553 2.248-9.107 2.68-13.661 2.418l4.834 10.404c-3.898-2.076-8.015-4.372-12.19-6.726v6.515l-5.57-11.244z"
    />
    <path
      d="M312.75 204.109c2.484 2.793 5.544 3.649 8.303 4.519l-1.367-3.258 8.092-.105-11.56-1.682-.315-.42c5.36-3.608 7.723-8.215 9.774-12.926l-10.825 5.99-7.461-10.194c.294 5.907 1.293 12.263 3.258 16.5-3.32-4.49-7.12-7.524-10.72-8.093 2.843 3.856 5.615 8.57 8.723 9.248l-5.99.736c2.827.163 1.28 2.512 10.088-.315z"
    />
    <path
      d="M297.298 237.336c2.19 4.029 2.091 8.057 2.417 12.085l1.262-9.353c4.087 1.816 5.619 4.27 7.566 6.621l-2.732-14.187-6.306-3.468c3.868.237 8.292-.273 10.785-2.511-3.814-2.73-5.336.857-12.466-1.483l-.946 2.733z"
    />
    <path
      d="M322.933 235.77c2.5 5.215.988 12.94 8.08 18.41.18-2.202.687-9.063-.513-13.47l15.763 12.68c.027-4.515-4.364-12.042-8.092-17.094l10.372-.775c-4.881-2.297-11.43-7.527-22.457-4.48l7.176-8.001-5.6-1.877-2.102 4.94-1.26-1.051z"
    />
    <path
      d="M317.769 260.032l-2.943 7.882 2.522-1.471 2.102 7.356 2.627-5.675 5.947 1.939-1.428-3.305 2.733-2.733-5.255-3.362 6.2-5.045-11.77 4.204z"
    />
    <path
      d="M386.963 183.316c-3.343 3.322-9.659 5.213-12.162 8.816 2.76-1.316 9.095-1.357 12.688-4.613-.396 3.397.929 6.41 3.047 9.248 1.051-2.276 2.102-5.187 3.153-9.143l10.777 7.477c-.591-5.676-5.117-11.251-10.462-13.572 4.001-1.07 8.31-1.876 10.365-4.613-3.464-2.01-9.065-2.965-13.097.304l-7.777-7.461c1.536 4.67 5.681 10.385 3.468 13.557z"
    />
    <path
      d="M414.396 166.186c1.676 3.233 6.138 7.69 7.534 9.524l-1.65-10.575c8.12 2.333 12.244 1.123 15.471-.406l-10.636-5.584 5.675-5.675-10.614 4.519-.21-2.417-6.096 3.468c-1.784 4.273-3.322 8.547-3.993 12.82 1.3-.242 2.957-3.343 4.519-5.674z"
    />
    <path
      d="M424.176 135.203l4.204 9.142v-5.99c5.425 4.168 9.206 3.61 12.4 1.366-2.872-1.382-5.744-2.073-8.617-4.729l12.365-5.196c-5.627-2.935-11.821-.494-16.148.993 1.791-2.365 5.956-7.737 5.226-13.463-3.259 3.187-9.492 8.156-9.43 12.727l-2.101-5.044-.316 7.882 2.523 2.942z"
    />
    <path
      d="M394.721 149.462l7.041 5.149h7.252l-6.936-5.044 5.675-4.099-5.045-2.102-4.414 2.627 5.15-12.295-8.513 9.038z"
    />
    <path
      d="M380.429 164.49l-2.312-10.3 4.519 3.784 6.62-10.089.316 6.2-1.471 6.096c2.069-1.08 4.945-1.403 11.454 1.681-3.158 1.92-7 3.02-11.56 3.258 5.006 2.221 9.89 4.498 11.876 8.092l-14.713-3.048z"
    />
    <path
      d="M345.11 151.064c3.562 2.686 6.801 6.017 11.14 7.146 5.416.808 9.723 2.112 12.673 1.276l-10.465-11.154-11.98-1.577c4.374-1.195 9.1-2.039 11.874-4.834l9.01-6.247c-7.027 2.306-17.572 2.287-22.776 7.718l1.26-11.35-3.888 7.777-7.671-.105 7.566 7.251-6.095 7.672 4.729-2.943c-2.152 4.371-.433 9.047 1.576 12.086l2.344 9.353c1.393-4.291 4.495-9.041 3.647-14.187z"
    />
    <path
      d="M430.576 145.697l-2.417 8.512 3.993-1.786 4.624 1.996c1-2.242-.675-4.484-2.417-6.725 4.414.29 10.944-1.612 15.358-4.302l-11.47-.217.736-2.523z"
    />
    <path
      d="M335.882 117.521l4.413-7.146v2.102l5.57-5.885c-1.15 4.648-3.065 5.858-4.729 8.197 4.716-1.757 10.468-2.133 15.974-2.838l-8.512 5.57-8.723 1.051 7.882 3.994 5.044 9.878-8.197-3.047-6.41-7.252.21 3.363-2.943 2.733z"
    />
    <path
      d="M317.386 147.712l.315-5.885 1.471 1.892c.312-2.649 1.625-5.964 2.732-9.143l.42 3.258-2.101 6.725 6.83-6.83 6.937-1.997-1.471 6.515-3.889 4.624 5.465-.315-1.892 6.306-9.983-2.418 6.41 5.045 4.94 10.72-9.564-4.835-5.044-9.879.525 11.56-2.522-9.353-1.576 2.207z"
    />
    <path
      d="M294.15 176.47l10.088 10.194 5.99-4.835c-.977-3.545-4.212-5.874-8.827-7.461 4.402-.219 8.452-1.851 12.295-4.309-3.822-1.254-5.593-3.71-17.098-.461l-4.13-2.902z"
    />
    <path
      d="M331.456 84.158c-4.448 2.207-11.572 6.515-17.202 5.473 2.6 2.343 9.977 2.792 12.577 2.759l3.956-4.22c-2.307 3.986-6.965 8.997-10.67 12.145 3.734-.908 7.706-2.55 12.565-8.803l.891-6.351c6.5-3.195 1.488-6.389 2.229-9.583l-1.132 7.886c-1.722-5.208-9.343-2.468-12.546-2.816 2.436 1.522 9.533 1.987 9.332 3.51z"
    />
    <path
      d="M343.547 46.383l8.914-1.449-4.791-2.006 5.237-6.908-7.8 4.68-2.118-8.58-1.114 9.248-8.357.223 7.577 2.897z"
    />
    <path
      d="M362.406 42.678l-1.783-5.126 3.12 1.56 1.895-6.686.223 4.569 3.454-1.895c.771 3.802-.87 4.536-3.343 5.683 1.65 1.04 4.322 2.08 3.789 3.12-.92 1.106-2.401 1.512-5.683-.334l2.117 4.68c-1.894-.596-2.742-3.283-3.789-5.571z"
    />
    <path
      d="M344.688 72.402l.669-3.343c1.964-1.277 8.97 1.85 11.226 4.067l-6.769.39c2.39.928 5.061 1.013 6.91 3.566l7.617 11.922c-1.937-.136-8.745-8.11-10.96-9.359l2.228 4.569-1.281 5.014-4.737-11.366z"
    />
    <path
      d="M347.781 58.891l3.9 4.792c5.461.334 7.774-.38 10.698-.892-4.137-2.019-8.177-4.716-12.592-4.791l7.131-2.34 2.34-2.117-9.694 3.008-3.232.223c-.558 3.91-.364 8.7-2.563 10.698l3.9-1.003c1.158-1.219.026-5.02.112-7.578z"
    />
    <path
      d="M345.496 52.317c-3.006.098-6.285 1.563-9.583 3.12 4 1.302 7.241 1.31 10.363 1.114l-2.005 6.018c1.005-2.97 2.57 2.736 3.008-9.026l5.015-1.338 2.674-5.014-6.463 4.346 3.232-5.795-4.68.446-.335 4.68-3.789-8.469-6.017-1.671 8.58 10.92z"
    />
  </svg>
</template>

<script>
import SimplexNoise from 'simplex-noise';

export const meta = {
  name: 'Plant projection mapping',
  date: '2020-07-06',
  link: 'https://twitter.com/callumacrae/status/1279855080523563009',
};

const simplexNoise = new SimplexNoise();

export default {
  data: () => ({
    frameId: undefined,
    algorithm: 'simplex',
  }),
  mounted() {
    this.children = Array.from(this.$el.children).map((element) => {
      if (element.tagName === 'path') {
        const match = /M\s*([-\d.]+)[\s,]+([-\d.]+)/.exec(
          element.getAttribute('d')
        );

        if (!match) {
          throw new Error('Failed to get x and y values');
        }

        return {
          x: Number(match[1]),
          y: Number(match[2]),
          element,
        };
      }

      if (element.tagName === 'rect') {
        return {
          x: Number(element.getAttribute('x')),
          y: Number(element.getAttribute('y')),
          element,
        };
      }

      throw new Error(`Element type "${element.tagName}" not supported`);
    });

    this.frame();
  },
  beforeUnmount() {
    cancelAnimationFrame(this.frameId);
  },
  methods: {
    frame(timestamp = 0) {
      this.children.forEach(({ x, y, element }) => {
        element.style.opacity = this.getValue(x, y, timestamp);
      });
      this.frameId = requestAnimationFrame(this.frame);
    },
    getValue(x, y, z) {
      if (this.algorithm === 'simplex') {
        return this.getSimplexValue(x, y, z);
      }
    },
    getSimplexValue(x, y, z) {
      const xScale = 1 / 100;
      const yScale = 1 / 100;
      const zScale = 1 / 6000;

      const noise = simplexNoise.noise3D(x * xScale, y * yScale, z * zScale);

      return noise < 0 ? 0 : noise;
    },
  },
};
</script>

<style scoped>
svg {
  background-color: black;
  width: 100vw;
  height: 100vh;
  fill: white;
}
</style>
